<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Competitions Page</title>
  <link rel="stylesheet" href="compPage.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<!-- ===== NAVBAR ===== -->
<header class="top-nav">
  <div class="nav-left">
    <img src="../loginPage/logoBlackPNG.png" alt="Logo" class="nav-logo">
    <h1 class="nav-title" data-key="compPageTitle">Competitions</h1>
  </div>
  <div class="nav-right">
    <div class="nav-links">
      <a href="requestsPage.html" class="nav-link">
        <div class="card">
          <li data-key="participationApps">Participation applications</li>
        </div>
      </a>

      <a href="listOfPPpage.html" class="nav-link active">
        <div class="card">
          <li data-key="participantsList">Prizes & Participants</li>
        </div>
      </a>
      
      <a href="planPage.html" class="nav-link">
        <div class="card">
          <li data-key="matchTiming">Matches & Games</li>
        </div>
      </a>
      
      <a href="pointsPage.html" class="nav-link">
        <div class="card">
          <li data-key="qualifiers">Qualifiers</li>
        </div>
      </a>
    </div>
    <div class="search-container">
      <input 
        type="text" 
        class="search-input" 
        placeholder="Search..." 
        data-key="searchPlaceholder"
        id="competition-search"
      />
      <i class="fas fa-search search-icon"></i>
    </div>
    <div class="language-switch">
      <span id="english-option" onclick="setLanguageWithHighlight('en')" class="active">English</span>
      <span id="arabic-option" onclick="setLanguageWithHighlight('ar')">العربية</span>
    </div>
  </div>
</header>
<!-- ===== END NAVBAR ===== -->

<!-- Floating puzzle icons - Moved outside of main-content to be in foreground -->
<div class="puzzle-icons">
  <img src="../adminPage/elements/puzzel1.png" alt="Puzzle 1" class="puzzle-icon icon1">
  <img src="../adminPage/elements/puzzel2.png" alt="Puzzle 2" class="puzzle-icon icon2">
  <img src="../adminPage/elements/puzzel3.png" alt="Puzzle 3" class="puzzle-icon icon3">
  <img src="../adminPage/elements/puzzel4.png" alt="Puzzle 4" class="puzzle-icon icon4">
</div>

<!-- Main Container -->
<div class="main-content">
  <!-- Create Competition Button -->
  <button 
        class="create-competition-btn" 
        onclick="window.location.href='createCompPage.html'"
    >
      <i class="fas fa-plus"></i> Create Competition
    </button>
  
  <!-- Filter controls for competitions -->
  <!-- <div class="filter-controls">
    <div class="filter-group">
      <label for="status-filter">Filter by Status:</label>
      <select id="status-filter" class="filter-select">
        <option value="all">All Statuses</option>
        <option value="in-progress">In Progress</option>
        <option value="ended">Ended</option>
        <option value="not-started">Not Started</option>
      </select>
    </div>
    <div class="filter-group">
      <label for="game-filter">Filter by Game:</label>
      <select id="game-filter" class="filter-select">
        <option value="all">All Games</option>
        <option value="fortnite">Fortnite</option>
        <option value="league-of-legends">League of Legends</option>
        <option value="fifa">FIFA</option>
        <option value="call-of-duty">Call of Duty</option>
        <option value="minecraft">Minecraft</option>
        <option value="rocket-league">Rocket League</option>
      </select>
    </div>
    <div class="filter-group">
      <label for="date-filter">Sort by:</label>
      <select id="date-filter" class="filter-select">
        <option value="newest">Newest First</option>
        <option value="oldest">Oldest First</option>
        <option value="prize-high">Prize (High to Low)</option>
        <option value="prize-low">Prize (Low to High)</option>
      </select>
    </div>
  </div> -->

  <!-- Left side: list/cards of competitions -->
  <div class="left-competitions">
    <h2>Existing Competitions <span class="competition-count">(3)</span></h2>

    <div id="competitions-container">
      <!-- Competition #1 -->
      <div 
        class="competition-card"
        data-name="Competition #1"
        data-max="16"
        data-begin="2025-04-10"
        data-end="2025-04-15"
        data-status="in-progress"
        data-description="This is a detailed description of Competition #1. It covers rules, prizes, and participant info."
        data-game="Chess"
        data-place="Sport Hall A"
      >
        <!-- Three dots menu -->
        <div class="card-menu">⋮</div>
        <!-- Dropdown menu (initially hidden) -->
        <div class="dropdown-menu">
          <ul>
            <li class="dropdown-item"><i class="fas fa-edit"></i> Edit</li>
            <li class="dropdown-item"><i class="fas fa-trash"></i> Remove</li>
            <li class="dropdown-item change-status-trigger">
              <i class="fas fa-exchange-alt"></i> Change Status
              <!-- Submenu for statuses -->
              <ul class="change-status-menu">
                <li data-status="in-progress">In Progress</li>
                <li data-status="ended">Ended</li>
                <li data-status="not-started">Not Started</li>
              </ul>
            </li>
          </ul>
        </div>

        <!-- Game icon badge -->
        <div class="game-badge">
          <i class="fas fa-chess"></i>
        </div>

        <!-- Basic Info (visible on the card) -->
        <h3 class="comp-name">Competition #1</h3>
        <div class="comp-details">
          <p class="comp-game"><i class="fas fa-gamepad"></i> Game: Chess</p>
          <p class="comp-max"><i class="fas fa-users"></i> Max Players: 16</p>
          <p class="comp-dates"><i class="far fa-calendar-alt"></i> Apr 10 - Apr 15, 2025</p>
          <p class="comp-place"><i class="fas fa-map-marker-alt"></i> Sport Hall A</p>
        </div>
        <div class="comp-status-bar">
          <p class="comp-status in-progress"><i class="fas fa-circle"></i> In Progress</p>
        </div>
      </div>

      <!-- Competition #2 -->
      <div 
        class="competition-card"
        data-name="Competition #2"
        data-max="30"
        data-begin="2025-04-10"
        data-end="2025-04-15"
        data-status="in-progress"
        data-description="Competition #2 has more players and a different prize structure."
        data-game="Football"
        data-place="Stadium B"
      >
        <!-- Three dots menu -->
        <div class="card-menu">⋮</div>
        <!-- Dropdown menu (initially hidden) -->
        <div class="dropdown-menu">
          <ul>
            <li class="dropdown-item"><i class="fas fa-edit"></i> Edit</li>
            <li class="dropdown-item"><i class="fas fa-trash"></i> Remove</li>
            <li class="dropdown-item change-status-trigger">
              <i class="fas fa-exchange-alt"></i> Change Status
              <!-- Submenu for statuses -->
              <ul class="change-status-menu">
                <li data-status="in-progress">In Progress</li>
                <li data-status="ended">Ended</li>
                <li data-status="not-started">Not Started</li>
              </ul>
            </li>
          </ul>
        </div>

        <!-- Game icon badge -->
        <div class="game-badge">
          <i class="fas fa-futbol"></i>
        </div>

        <!-- Basic Info (visible on the card) -->
        <h3 class="comp-name">Competition #2</h3>
        <div class="comp-details">
          <p class="comp-game"><i class="fas fa-gamepad"></i> Game: Football</p>
          <p class="comp-max"><i class="fas fa-users"></i> Max Players: 30</p>
          <p class="comp-dates"><i class="far fa-calendar-alt"></i> Apr 10 - Apr 15, 2025</p>
          <p class="comp-place"><i class="fas fa-map-marker-alt"></i> Stadium B</p>
        </div>
        <div class="comp-status-bar">
          <p class="comp-status in-progress"><i class="fas fa-circle"></i> In Progress</p>
        </div>
      </div>

      <!-- Competition #3 -->
      <div 
        class="competition-card"
        data-name="Competition #3"
        data-max="50"
        data-begin="2025-04-10"
        data-end="2025-04-15"
        data-status="ended"
        data-description="Competition #3 has ended. This one had the largest number of participants and interesting outcomes."
        data-game="Basketball"
        data-place="Indoor Court C"
      >
        <!-- Three dots menu -->
        <div class="card-menu">⋮</div>
        <!-- Dropdown menu (initially hidden) -->
        <div class="dropdown-menu">
          <ul>
            <li class="dropdown-item"><i class="fas fa-edit"></i> Edit</li>
            <li class="dropdown-item"><i class="fas fa-trash"></i> Remove</li>
            <li class="dropdown-item change-status-trigger">
              <i class="fas fa-exchange-alt"></i> Change Status
              <!-- Submenu for statuses -->
              <ul class="change-status-menu">
                <li data-status="in-progress">In Progress</li>
                <li data-status="ended">Ended</li>
                <li data-status="not-started">Not Started</li>
              </ul>
            </li>
          </ul>
        </div>

        <!-- Game icon badge -->
        <div class="game-badge">
          <i class="fas fa-basketball-ball"></i>
        </div>

        <!-- Basic Info (visible on the card) -->
        <h3 class="comp-name">Competition #3</h3>
        <div class="comp-details">
          <p class="comp-game"><i class="fas fa-gamepad"></i> Game: Basketball</p>
          <p class="comp-max"><i class="fas fa-users"></i> Max Players: 50</p>
          <p class="comp-dates"><i class="far fa-calendar-alt"></i> Apr 10 - Apr 15, 2025</p>
          <p class="comp-place"><i class="fas fa-map-marker-alt"></i> Indoor Court C</p>
        </div>
        <div class="comp-status-bar">
          <p class="comp-status ended"><i class="fas fa-circle"></i> Ended</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Right side: details for the clicked competition -->
  <div class="right-details">
    <div class="right-details-placeholder">
      <i class="fas fa-hand-point-left"></i>
      <h2>Competition Details</h2>
      <p>Select a competition on the left to view its details here.</p>
    </div>
    
    <div class="details-content hidden">
      <!-- Content will be populated by JavaScript -->
    </div>
  </div>
</div>

<!-- Delete confirmation modal -->
<div class="modal" id="delete-modal">
  <div class="modal-content">
    <h3><i class="fas fa-exclamation-triangle"></i> Confirm Deletion</h3>
    <p>Are you sure you want to delete this competition? This action cannot be undone.</p>
    <p class="competition-to-delete"></p>
    <div class="modal-buttons">
      <button class="btn cancel-btn"><i class="fas fa-times"></i> Cancel</button>
      <button class="btn confirm-btn"><i class="fas fa-trash"></i> Delete</button>
    </div>
  </div>
</div>

<!-- Toast notification -->
<div class="toast" id="toast">
  <div class="toast-content">
    <i class="toast-icon"></i>
    <span class="toast-message"></span>
  </div>
  <div class="toast-progress"></div>
</div>

<!-- Scripts -->
<script src="../loginPage/translations.js"></script>
<script>
  // Load saved or default language
  const savedLang = localStorage.getItem('lang') || 'en';
  
  function setLanguageWithHighlight(lang) {
    // Store the language preference
    localStorage.setItem('lang', lang);
    
    // Update the UI to highlight the selected language
    document.getElementById('english-option').classList.toggle('active', lang === 'en');
    document.getElementById('arabic-option').classList.toggle('active', lang === 'ar');
    
    // Set the text direction
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    
    // Update all translatable elements
    if (typeof translations !== 'undefined' && translations[lang]) {
      document.querySelectorAll('[data-key]').forEach(elem => {
        const key = elem.getAttribute('data-key');
        if (translations[lang][key]) {
          if (elem.tagName === 'INPUT') {
            elem.placeholder = translations[lang][key];
          } else {
            elem.textContent = translations[lang][key];
          }
        }
      });
    }
  }
  
  // Initialize language
  setLanguageWithHighlight(savedLang);

  // Check for newly created competition from localStorage
  document.addEventListener('DOMContentLoaded', function() {
    // Check if there's a newly created competition in localStorage
    const newCompetition = JSON.parse(localStorage.getItem('newCompetition'));
    
    if (newCompetition) {
      // Add the new competition to the list
      addNewCompetition(newCompetition);
      
      // Show success toast
      showToast('success', `Competition "${newCompetition.name}" has been created successfully!`);
      
      // Clear the localStorage after adding
      localStorage.removeItem('newCompetition');
    }
    
    // Update competition count
    updateCompetitionCount();
    
    // Set up puzzle animation with enhanced effect
    setupPuzzleAnimation();
  });

  // Enhanced puzzle animation
  function setupPuzzleAnimation() {
    const puzzleIcons = document.querySelectorAll('.puzzle-icon');
    
    document.addEventListener('mousemove', (e) => {
      const mouseX = e.clientX;
      const mouseY = e.clientY;
      
      puzzleIcons.forEach((icon, index) => {
        // Calculate distance from mouse to center of screen
        const centerX = window.innerWidth / 2;
        const centerY = window.innerHeight / 2;
        const offsetX = mouseX - centerX;
        const offsetY = mouseY - centerY;
        
        // Different intensity for each puzzle piece
        const intensity = (index + 1) * 0.02;
        
        // Calculate rotation based on mouse position
        const rotation = offsetX * intensity * 0.5;
        
        // Calculate translation
        const translateX = offsetX * intensity;
        const translateY = offsetY * intensity;
        
        // Apply transform with enhanced 3D effect
        icon.style.transform = `
          translate3d(${translateX}px, ${translateY}px, 0)
          rotate(${rotation}deg)
          scale(${1 + intensity * 0.1})
        `;
      });
    });
  }

  // Function to add a new competition to the list
  function addNewCompetition(competition) {
    const container = document.getElementById('competitions-container');
    
    // Create a new competition card
    const card = document.createElement('div');
    card.className = 'competition-card';
    card.setAttribute('data-name', competition.name);
    card.setAttribute('data-max', competition.maxPlayers);
    card.setAttribute('data-begin', competition.beginDate);
    card.setAttribute('data-end', competition.endDate);
    card.setAttribute('data-status', 'not-started');
    card.setAttribute('data-description', competition.description);
    card.setAttribute('data-game', competition.game);
    card.setAttribute('data-place', competition.place);
    
    // Format dates for display
    const beginDate = new Date(competition.beginDate);
    const endDate = new Date(competition.endDate);
    const formattedBegin = beginDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    const formattedEnd = endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    
    // Determine icon based on game name
    let gameIcon = 'gamepad';
    if (competition.game.toLowerCase().includes('chess')) gameIcon = 'chess';
    else if (competition.game.toLowerCase().includes('football') || competition.game.toLowerCase().includes('soccer')) gameIcon = 'futbol';
    else if (competition.game.toLowerCase().includes('basketball')) gameIcon = 'basketball-ball';
    else if (competition.game.toLowerCase().includes('tennis')) gameIcon = 'table-tennis';
    else if (competition.game.toLowerCase().includes('volleyball')) gameIcon = 'volleyball-ball';
    
    // Create card HTML
    card.innerHTML = `
      <!-- Three dots menu -->
      <div class="card-menu">⋮</div>
      <!-- Dropdown menu (initially hidden) -->
      <div class="dropdown-menu">
        <ul>
          <li class="dropdown-item"><i class="fas fa-edit"></i> Edit</li>
          <li class="dropdown-item"><i class="fas fa-trash"></i> Remove</li>
          <li class="dropdown-item change-status-trigger">
            <i class="fas fa-exchange-alt"></i> Change Status
            <!-- Submenu for statuses -->
            <ul class="change-status-menu">
              <li data-status="in-progress">In Progress</li>
              <li data-status="ended">Ended</li>
              <li data-status="not-started">Not Started</li>
            </ul>
          </li>
        </ul>
      </div>

      <!-- Game icon badge -->
      <div class="game-badge">
        <i class="fas fa-${gameIcon}"></i>
      </div>

      <!-- Basic Info (visible on the card) -->
      <h3 class="comp-name">${competition.name}</h3>
      <div class="comp-details">
        <p class="comp-game"><i class="fas fa-gamepad"></i> Game: ${competition.game}</p>
        <p class="comp-max"><i class="fas fa-users"></i> Max Players: ${competition.maxPlayers}</p>
        <p class="comp-dates"><i class="far fa-calendar-alt"></i> ${formattedBegin} - ${formattedEnd}</p>
        <p class="comp-place"><i class="fas fa-map-marker-alt"></i> ${competition.place}</p>
      </div>
      <div class="comp-status-bar">
        <p class="comp-status not-started"><i class="fas fa-circle"></i> Not Started</p>
      </div>
    `;
    
    // Add the new card to the beginning of the container
    container.insertBefore(card, container.firstChild);
    
    // Set up event listeners for the new card
    setupCardEventListeners(card);
  }

  // Function to set up event listeners for a competition card
  function setupCardEventListeners(card) {
    // Card click event
    card.addEventListener('click', (e) => {
      if (e.target.closest('.card-menu') || e.target.closest('.dropdown-menu')) {
        return;
      }
      
      // Remove active class from all cards
      document.querySelectorAll('.competition-card').forEach(c => {
        c.classList.remove('active');
      });
      
      // Add active class to clicked card
      card.classList.add('active');
      
      // Get competition data
      const name = card.getAttribute('data-name');
      const maxPlayers = card.getAttribute('data-max');
      const beginDate = card.getAttribute('data-begin');
      const endDate = card.getAttribute('data-end');
      const status = card.getAttribute('data-status');
      const description = card.getAttribute('data-description');
      const game = card.getAttribute('data-game');
      const place = card.getAttribute('data-place');
      
      // Format dates for better display
      const formattedBegin = new Date(beginDate).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
      
      const formattedEnd = new Date(endDate).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
      
      // Hide placeholder and show content
      document.querySelector('.right-details-placeholder').classList.add('hidden');
      const detailsContent = document.querySelector('.details-content');
      detailsContent.classList.remove('hidden');
      
      // Create content HTML
      detailsContent.innerHTML = `
        <h2>${name} Details</h2>
        <ul class="detail-list">
          <li><strong>Game:</strong> ${game}</li>
          <li><strong>Max Players:</strong> ${maxPlayers}</li>
          <li><strong>Location:</strong> ${place}</li>
          <li><strong>Begin Date:</strong> ${formattedBegin}</li>
          <li><strong>End Date:</strong> ${formattedEnd}</li>
          <li><strong>Status:</strong> ${status.charAt(0).toUpperCase() + status.slice(1).replace(/-/g, ' ')}</li>
          <li><strong>Description:</strong> ${description}</li>
        </ul>
        
        <div class="action-buttons">
          <button class="btn primary-btn"><i class="fas fa-edit"></i> Edit Competition</button>
          <button class="btn secondary-btn" onclick="window.location.href='listOfPPpage.html'">
            <i class="fas fa-users"></i> Manage Participants
          </button>
          ${status === 'ended' ? 
            `<button class="btn success-btn"><i class="fas fa-trophy"></i> View Results</button>` : ''}
        </div>
      `;
    });
    
    // Menu click event
    const menu = card.querySelector('.card-menu');
    menu.addEventListener('click', (e) => {
      e.stopPropagation();
      const dropdown = menu.nextElementSibling;
      
      // Close all other dropdowns first
      document.querySelectorAll('.dropdown-menu').forEach(d => {
        if (d !== dropdown) d.classList.remove('show');
      });
      
      // Toggle this dropdown
      dropdown.classList.toggle('show');
    });
    
    // Dropdown item actions
    card.querySelectorAll('.dropdown-item').forEach(item => {
      item.addEventListener('click', (e) => {
        e.stopPropagation();
        const competitionName = card.getAttribute('data-name');
        
        if (item.textContent.includes('Edit')) {
          showToast('info', `Editing ${competitionName}...`);
        } 
        else if (item.textContent.includes('Remove')) {
          // Show delete confirmation
          const modal = document.getElementById('delete-modal');
          modal.classList.add('show');
          modal.querySelector('.competition-to-delete').textContent = competitionName;
          
          // Set up modal buttons
          modal.querySelector('.cancel-btn').onclick = () => {
            modal.classList.remove('show');
          };
          
          modal.querySelector('.confirm-btn').onclick = () => {
            // Delete the competition
            card.remove();
            modal.classList.remove('show');
            showToast('success', `${competitionName} has been deleted`);
            
            // Update competition count
            updateCompetitionCount();
            
            // If the deleted card was selected, reset the details panel
            if (card.classList.contains('active')) {
              document.querySelector('.right-details-placeholder').classList.remove('hidden');
              document.querySelector('.details-content').classList.add('hidden');
            }
          };
        }
        
        // Close the dropdown
        item.closest('.dropdown-menu').classList.remove('show');
      });
    });
    
    // Status change handling - Improved to directly change status
    const statusTrigger = card.querySelector('.change-status-trigger');
    if (statusTrigger) {
      statusTrigger.addEventListener('mouseenter', () => {
        statusTrigger.querySelector('.change-status-menu').style.display = 'block';
      });
      
      statusTrigger.addEventListener('mouseleave', () => {
        statusTrigger.querySelector('.change-status-menu').style.display = 'none';
      });
      
      card.querySelectorAll('.change-status-menu li').forEach(option => {
        option.addEventListener('click', (e) => {
          e.stopPropagation();
          
          const newStatus = option.getAttribute('data-status');
          const statusElement = card.querySelector('.comp-status');
          
          // Remove old status classes
          statusElement.classList.remove('in-progress', 'ended', 'not-started');
          
          // Update the status attribute on the card
          card.setAttribute('data-status', newStatus);
          
          // Add the new status class
          statusElement.classList.add(newStatus);
          
          // Update the status text
          const statusText = newStatus === 'in-progress' 
                            ? 'In Progress' 
                            : newStatus === 'ended' 
                              ? 'Ended' 
                              : 'Not Started';
          
          statusElement.innerHTML = `<i class="fas fa-circle"></i> ${statusText}`;
          
          // Show toast notification
          showToast('success', `Status updated to ${statusText}`);
          
          // Hide status menu
          option.closest('.change-status-menu').style.display = 'none';
          option.closest('.dropdown-menu').classList.remove('show');
          
          // If the card is currently selected, refresh the details panel
          if (card.classList.contains('active')) {
            card.click();
          }
        });
      });
    }
  }

  // Set up event listeners for existing cards
  document.querySelectorAll('.competition-card').forEach(card => {
    setupCardEventListeners(card);
  });

  // Close dropdowns when clicking outside
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.dropdown-menu') && !e.target.closest('.card-menu')) {
      document.querySelectorAll('.dropdown-menu').forEach(d => {
        d.classList.remove('show');
      });
    }
  });
  
  // SEARCH FUNCTIONALITY
  document.getElementById('competition-search').addEventListener('input', (e) => {
    const searchTerm = e.target.value.toLowerCase();
    
    document.querySelectorAll('.competition-card').forEach(card => {
      const competitionName = card.getAttribute('data-name').toLowerCase();
      const gameType = card.getAttribute('data-game').toLowerCase();
      
      if (competitionName.includes(searchTerm) || gameType.includes(searchTerm)) {
        card.style.display = 'block';
      } else {
        card.style.display = 'none';
      }
    });
    
    // Update competition count
    updateCompetitionCount();
  });
  
  // COUNT VISIBLE COMPETITIONS
  function updateCompetitionCount() {
    const visibleCount = Array.from(document.querySelectorAll('.competition-card'))
      .filter(card => card.style.display !== 'none')
      .length;
    
    document.querySelector('.competition-count').textContent = `(${visibleCount})`;
  }
  
  // TOAST NOTIFICATION FUNCTION
  function showToast(type, message) {
    const toast = document.getElementById('toast');
    const toastIcon = toast.querySelector('.toast-icon');
    const toastMessage = toast.querySelector('.toast-message');
    const toastProgress = toast.querySelector('.toast-progress');
    
    // Set icon based on type
    if (type === 'success') {
      toastIcon.className = 'toast-icon fas fa-check-circle';
      toast.className = 'toast toast-success show';
    } else if (type === 'error') {
      toastIcon.className = 'toast-icon fas fa-exclamation-circle';
      toast.className = 'toast toast-error show';
    } else if (type === 'warning') {
      toastIcon.className = 'toast-icon fas fa-exclamation-triangle';
      toast.className = 'toast toast-warning show';
    } else {
      toastIcon.className = 'toast-icon fas fa-info-circle';
      toast.className = 'toast toast-info show';
    }
    
    // Set message
    toastMessage.textContent = message;
    
    // Reset progress animation
    toastProgress.style.animation = 'none';
    toastProgress.offsetHeight; // Trigger reflow
    toastProgress.style.animation = 'progress 3s linear forwards';
    
    // Hide toast after 3 seconds
    setTimeout(() => {
      toast.classList.remove('show');
    }, 3000);
  }
  
  // CLOSE MODAL WHEN CLICKING OUTSIDE
  window.addEventListener('click', (e) => {
    const modal = document.getElementById('delete-modal');
    if (e.target === modal) {
      modal.classList.remove('show');
    }
  });
  
  // INITIALIZE ACTIVE NAV LINK
  document.addEventListener("DOMContentLoaded", function() {
    const currentPage = window.location.pathname.split("/").pop();
    
    document.querySelectorAll(".nav-link").forEach(link => {
      const linkPage = link.getAttribute("href");
      if (linkPage === currentPage) {
        link.classList.add("active");
      } else {
        link.classList.remove("active");
      }
    });
  });
</script>
</body>
</html>
